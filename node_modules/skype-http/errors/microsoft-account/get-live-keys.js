"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const incident_1 = require("incident");
var MsprequCookieNotFoundError;
(function (MsprequCookieNotFoundError) {
    MsprequCookieNotFoundError.name = "MsprequCookieNotFound";
})(MsprequCookieNotFoundError = exports.MsprequCookieNotFoundError || (exports.MsprequCookieNotFoundError = {}));
(function (MsprequCookieNotFoundError) {
    function format({ response, request }) {
        return "Unable to find the MSPRequ cookie for https://login.live.com/."
            + " This cookie is normally set in the response headers."
            + " This error may be caused by a change in the Microsoft login workflow."
            + ` Request: ${JSON.stringify(request)}, Response: ${response}`;
    }
    MsprequCookieNotFoundError.format = format;
    function create(request, response) {
        return new incident_1.Incident(MsprequCookieNotFoundError.name, { request, response }, format);
    }
    MsprequCookieNotFoundError.create = create;
})(MsprequCookieNotFoundError = exports.MsprequCookieNotFoundError || (exports.MsprequCookieNotFoundError = {}));
var MspokCookieNotFoundError;
(function (MspokCookieNotFoundError) {
    MspokCookieNotFoundError.name = "MspokCookieNotFound";
})(MspokCookieNotFoundError = exports.MspokCookieNotFoundError || (exports.MspokCookieNotFoundError = {}));
(function (MspokCookieNotFoundError) {
    function format({ response, request }) {
        return "Unable to find the MSPOK cookie for https://login.live.com/."
            + " This cookie is normally set in the response headers."
            + " This error may be caused by a change in the Microsoft login workflow."
            + ` Request: ${JSON.stringify(request)}, Response: ${response}`;
    }
    MspokCookieNotFoundError.format = format;
    function create(request, response) {
        return new incident_1.Incident(MspokCookieNotFoundError.name, { request, response }, format);
    }
    MspokCookieNotFoundError.create = create;
})(MspokCookieNotFoundError = exports.MspokCookieNotFoundError || (exports.MspokCookieNotFoundError = {}));
var PpftKeyNotFoundError;
(function (PpftKeyNotFoundError) {
    PpftKeyNotFoundError.name = "PpftKeyNotFound";
})(PpftKeyNotFoundError = exports.PpftKeyNotFoundError || (exports.PpftKeyNotFoundError = {}));
(function (PpftKeyNotFoundError) {
    function format({ html }) {
        return "Unable to find the PPFT key for https://login.live.com/."
            + " This key is normally found in the HTML response, in a Javascript literal string containing an HTML input"
            + " with the attribute name=\"PPFT\", the key is the value of this input and is extracted with a regular"
            + " expression. This error may be caused by a change in the Microsoft login workflow."
            + ` HTML page: ${JSON.stringify(html)}`;
    }
    PpftKeyNotFoundError.format = format;
    function create(html) {
        return new incident_1.Incident(PpftKeyNotFoundError.name, { html }, format);
    }
    PpftKeyNotFoundError.create = create;
})(PpftKeyNotFoundError = exports.PpftKeyNotFoundError || (exports.PpftKeyNotFoundError = {}));
var GetLiveKeysError;
(function (GetLiveKeysError) {
    GetLiveKeysError.name = "GetLiveKeys";
})(GetLiveKeysError = exports.GetLiveKeysError || (exports.GetLiveKeysError = {}));
(function (GetLiveKeysError) {
    function format() {
        return "Unable to get the MSPRequ, MSPOK and PPFT keys from login.live.com";
    }
    GetLiveKeysError.format = format;
    function create(cause) {
        return incident_1.Incident(cause, GetLiveKeysError.name, {}, format);
    }
    GetLiveKeysError.create = create;
})(GetLiveKeysError = exports.GetLiveKeysError || (exports.GetLiveKeysError = {}));

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIl9zcmMvZXJyb3JzL21pY3Jvc29mdC1hY2NvdW50L2dldC1saXZlLWtleXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSx1Q0FBb0M7QUFJcEMsSUFBaUIsMEJBQTBCLENBVTFDO0FBVkQsV0FBaUIsMEJBQTBCO0lBRTVCLCtCQUFJLEdBQVMsdUJBQXVCLENBQUM7QUFRcEQsQ0FBQyxFQVZnQiwwQkFBMEIsR0FBMUIsa0NBQTBCLEtBQTFCLGtDQUEwQixRQVUxQztBQU1ELFdBQWlCLDBCQUEwQjtJQUd6QyxnQkFBdUIsRUFBQyxRQUFRLEVBQUUsT0FBTyxFQUFPO1FBQzlDLE1BQU0sQ0FBQyxnRUFBZ0U7Y0FDbkUsdURBQXVEO2NBQ3ZELHdFQUF3RTtjQUN4RSxhQUFhLElBQUksQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLGVBQWUsUUFBUSxFQUFFLENBQUM7SUFDcEUsQ0FBQztJQUxlLGlDQUFNLFNBS3JCLENBQUE7SUFFRCxnQkFBdUIsT0FBMEIsRUFBRSxRQUF5QjtRQUMxRSxNQUFNLENBQUMsSUFBSSxtQkFBUSxDQUFDLDJCQUFBLElBQUksRUFBRSxFQUFDLE9BQU8sRUFBRSxRQUFRLEVBQUMsRUFBRSxNQUFNLENBQUMsQ0FBQztJQUN6RCxDQUFDO0lBRmUsaUNBQU0sU0FFckIsQ0FBQTtBQUNILENBQUMsRUFiZ0IsMEJBQTBCLEdBQTFCLGtDQUEwQixLQUExQixrQ0FBMEIsUUFhMUM7QUFFRCxJQUFpQix3QkFBd0IsQ0FVeEM7QUFWRCxXQUFpQix3QkFBd0I7SUFFMUIsNkJBQUksR0FBUyxxQkFBcUIsQ0FBQztBQVFsRCxDQUFDLEVBVmdCLHdCQUF3QixHQUF4QixnQ0FBd0IsS0FBeEIsZ0NBQXdCLFFBVXhDO0FBTUQsV0FBaUIsd0JBQXdCO0lBR3ZDLGdCQUF1QixFQUFDLFFBQVEsRUFBRSxPQUFPLEVBQU87UUFDOUMsTUFBTSxDQUFDLDhEQUE4RDtjQUNqRSx1REFBdUQ7Y0FDdkQsd0VBQXdFO2NBQ3hFLGFBQWEsSUFBSSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsZUFBZSxRQUFRLEVBQUUsQ0FBQztJQUNwRSxDQUFDO0lBTGUsK0JBQU0sU0FLckIsQ0FBQTtJQUVELGdCQUF1QixPQUEwQixFQUFFLFFBQXlCO1FBQzFFLE1BQU0sQ0FBQyxJQUFJLG1CQUFRLENBQUMseUJBQUEsSUFBSSxFQUFFLEVBQUMsT0FBTyxFQUFFLFFBQVEsRUFBQyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0lBQ3pELENBQUM7SUFGZSwrQkFBTSxTQUVyQixDQUFBO0FBQ0gsQ0FBQyxFQWJnQix3QkFBd0IsR0FBeEIsZ0NBQXdCLEtBQXhCLGdDQUF3QixRQWF4QztBQUVELElBQWlCLG9CQUFvQixDQVNwQztBQVRELFdBQWlCLG9CQUFvQjtJQUV0Qix5QkFBSSxHQUFTLGlCQUFpQixDQUFDO0FBTzlDLENBQUMsRUFUZ0Isb0JBQW9CLEdBQXBCLDRCQUFvQixLQUFwQiw0QkFBb0IsUUFTcEM7QUFNRCxXQUFpQixvQkFBb0I7SUFHbkMsZ0JBQXVCLEVBQUMsSUFBSSxFQUFPO1FBQ2pDLE1BQU0sQ0FBQywwREFBMEQ7Y0FDN0QsMkdBQTJHO2NBQzNHLHVHQUF1RztjQUN2RyxvRkFBb0Y7Y0FDcEYsZUFBZSxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUM7SUFDNUMsQ0FBQztJQU5lLDJCQUFNLFNBTXJCLENBQUE7SUFFRCxnQkFBdUIsSUFBWTtRQUNqQyxNQUFNLENBQUMsSUFBSSxtQkFBUSxDQUFDLHFCQUFBLElBQUksRUFBRSxFQUFDLElBQUksRUFBQyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0lBQzVDLENBQUM7SUFGZSwyQkFBTSxTQUVyQixDQUFBO0FBQ0gsQ0FBQyxFQWRnQixvQkFBb0IsR0FBcEIsNEJBQW9CLEtBQXBCLDRCQUFvQixRQWNwQztBQUVELElBQWlCLGdCQUFnQixDQVFoQztBQVJELFdBQWlCLGdCQUFnQjtJQUVsQixxQkFBSSxHQUFTLGFBQWEsQ0FBQztBQU0xQyxDQUFDLEVBUmdCLGdCQUFnQixHQUFoQix3QkFBZ0IsS0FBaEIsd0JBQWdCLFFBUWhDO0FBSUQsV0FBaUIsZ0JBQWdCO0lBRy9CO1FBQ0UsTUFBTSxDQUFDLG9FQUFvRSxDQUFDO0lBQzlFLENBQUM7SUFGZSx1QkFBTSxTQUVyQixDQUFBO0lBRUQsZ0JBQXVCLEtBQVk7UUFDakMsTUFBTSxDQUFDLG1CQUFRLENBQUMsS0FBSyxFQUFFLGlCQUFBLElBQUksRUFBRSxFQUFFLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDM0MsQ0FBQztJQUZlLHVCQUFNLFNBRXJCLENBQUE7QUFDSCxDQUFDLEVBVmdCLGdCQUFnQixHQUFoQix3QkFBZ0IsS0FBaEIsd0JBQWdCLFFBVWhDIiwiZmlsZSI6ImVycm9ycy9taWNyb3NvZnQtYWNjb3VudC9nZXQtbGl2ZS1rZXlzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5jaWRlbnQgfSBmcm9tIFwiaW5jaWRlbnRcIjtcbmltcG9ydCAqIGFzIGh0dHBJbyBmcm9tIFwiLi4vLi4vaW50ZXJmYWNlcy9odHRwLWlvXCI7XG5pbXBvcnQgeyBSZXF1ZXN0RXJyb3IgfSBmcm9tIFwiLi4vaHR0cFwiO1xuXG5leHBvcnQgbmFtZXNwYWNlIE1zcHJlcXVDb29raWVOb3RGb3VuZEVycm9yIHtcbiAgZXhwb3J0IHR5cGUgTmFtZSA9IFwiTXNwcmVxdUNvb2tpZU5vdEZvdW5kXCI7XG4gIGV4cG9ydCBjb25zdCBuYW1lOiBOYW1lID0gXCJNc3ByZXF1Q29va2llTm90Rm91bmRcIjtcblxuICBleHBvcnQgaW50ZXJmYWNlIERhdGEge1xuICAgIHJlcXVlc3Q6IGh0dHBJby5HZXRPcHRpb25zO1xuICAgIHJlc3BvbnNlOiBodHRwSW8uUmVzcG9uc2U7XG4gIH1cblxuICBleHBvcnQgdHlwZSBDYXVzZSA9IHVuZGVmaW5lZDtcbn1cblxuZXhwb3J0IHR5cGUgTXNwcmVxdUNvb2tpZU5vdEZvdW5kRXJyb3IgPSBJbmNpZGVudDxNc3ByZXF1Q29va2llTm90Rm91bmRFcnJvci5EYXRhLFxuICBNc3ByZXF1Q29va2llTm90Rm91bmRFcnJvci5OYW1lLFxuICBNc3ByZXF1Q29va2llTm90Rm91bmRFcnJvci5DYXVzZT47XG5cbmV4cG9ydCBuYW1lc3BhY2UgTXNwcmVxdUNvb2tpZU5vdEZvdW5kRXJyb3Ige1xuICBleHBvcnQgdHlwZSBUeXBlID0gTXNwcmVxdUNvb2tpZU5vdEZvdW5kRXJyb3I7XG5cbiAgZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdCh7cmVzcG9uc2UsIHJlcXVlc3R9OiBEYXRhKSB7XG4gICAgcmV0dXJuIFwiVW5hYmxlIHRvIGZpbmQgdGhlIE1TUFJlcXUgY29va2llIGZvciBodHRwczovL2xvZ2luLmxpdmUuY29tLy5cIlxuICAgICAgKyBcIiBUaGlzIGNvb2tpZSBpcyBub3JtYWxseSBzZXQgaW4gdGhlIHJlc3BvbnNlIGhlYWRlcnMuXCJcbiAgICAgICsgXCIgVGhpcyBlcnJvciBtYXkgYmUgY2F1c2VkIGJ5IGEgY2hhbmdlIGluIHRoZSBNaWNyb3NvZnQgbG9naW4gd29ya2Zsb3cuXCJcbiAgICAgICsgYCBSZXF1ZXN0OiAke0pTT04uc3RyaW5naWZ5KHJlcXVlc3QpfSwgUmVzcG9uc2U6ICR7cmVzcG9uc2V9YDtcbiAgfVxuXG4gIGV4cG9ydCBmdW5jdGlvbiBjcmVhdGUocmVxdWVzdDogaHR0cElvLkdldE9wdGlvbnMsIHJlc3BvbnNlOiBodHRwSW8uUmVzcG9uc2UpOiBNc3ByZXF1Q29va2llTm90Rm91bmRFcnJvciB7XG4gICAgcmV0dXJuIG5ldyBJbmNpZGVudChuYW1lLCB7cmVxdWVzdCwgcmVzcG9uc2V9LCBmb3JtYXQpO1xuICB9XG59XG5cbmV4cG9ydCBuYW1lc3BhY2UgTXNwb2tDb29raWVOb3RGb3VuZEVycm9yIHtcbiAgZXhwb3J0IHR5cGUgTmFtZSA9IFwiTXNwb2tDb29raWVOb3RGb3VuZFwiO1xuICBleHBvcnQgY29uc3QgbmFtZTogTmFtZSA9IFwiTXNwb2tDb29raWVOb3RGb3VuZFwiO1xuXG4gIGV4cG9ydCBpbnRlcmZhY2UgRGF0YSB7XG4gICAgcmVxdWVzdDogaHR0cElvLkdldE9wdGlvbnM7XG4gICAgcmVzcG9uc2U6IGh0dHBJby5SZXNwb25zZTtcbiAgfVxuXG4gIGV4cG9ydCB0eXBlIENhdXNlID0gdW5kZWZpbmVkO1xufVxuXG5leHBvcnQgdHlwZSBNc3Bva0Nvb2tpZU5vdEZvdW5kRXJyb3IgPSBJbmNpZGVudDxNc3Bva0Nvb2tpZU5vdEZvdW5kRXJyb3IuRGF0YSxcbiAgTXNwb2tDb29raWVOb3RGb3VuZEVycm9yLk5hbWUsXG4gIE1zcG9rQ29va2llTm90Rm91bmRFcnJvci5DYXVzZT47XG5cbmV4cG9ydCBuYW1lc3BhY2UgTXNwb2tDb29raWVOb3RGb3VuZEVycm9yIHtcbiAgZXhwb3J0IHR5cGUgVHlwZSA9IE1zcG9rQ29va2llTm90Rm91bmRFcnJvcjtcblxuICBleHBvcnQgZnVuY3Rpb24gZm9ybWF0KHtyZXNwb25zZSwgcmVxdWVzdH06IERhdGEpIHtcbiAgICByZXR1cm4gXCJVbmFibGUgdG8gZmluZCB0aGUgTVNQT0sgY29va2llIGZvciBodHRwczovL2xvZ2luLmxpdmUuY29tLy5cIlxuICAgICAgKyBcIiBUaGlzIGNvb2tpZSBpcyBub3JtYWxseSBzZXQgaW4gdGhlIHJlc3BvbnNlIGhlYWRlcnMuXCJcbiAgICAgICsgXCIgVGhpcyBlcnJvciBtYXkgYmUgY2F1c2VkIGJ5IGEgY2hhbmdlIGluIHRoZSBNaWNyb3NvZnQgbG9naW4gd29ya2Zsb3cuXCJcbiAgICAgICsgYCBSZXF1ZXN0OiAke0pTT04uc3RyaW5naWZ5KHJlcXVlc3QpfSwgUmVzcG9uc2U6ICR7cmVzcG9uc2V9YDtcbiAgfVxuXG4gIGV4cG9ydCBmdW5jdGlvbiBjcmVhdGUocmVxdWVzdDogaHR0cElvLkdldE9wdGlvbnMsIHJlc3BvbnNlOiBodHRwSW8uUmVzcG9uc2UpOiBNc3Bva0Nvb2tpZU5vdEZvdW5kRXJyb3Ige1xuICAgIHJldHVybiBuZXcgSW5jaWRlbnQobmFtZSwge3JlcXVlc3QsIHJlc3BvbnNlfSwgZm9ybWF0KTtcbiAgfVxufVxuXG5leHBvcnQgbmFtZXNwYWNlIFBwZnRLZXlOb3RGb3VuZEVycm9yIHtcbiAgZXhwb3J0IHR5cGUgTmFtZSA9IFwiUHBmdEtleU5vdEZvdW5kXCI7XG4gIGV4cG9ydCBjb25zdCBuYW1lOiBOYW1lID0gXCJQcGZ0S2V5Tm90Rm91bmRcIjtcblxuICBleHBvcnQgaW50ZXJmYWNlIERhdGEge1xuICAgIGh0bWw6IHN0cmluZztcbiAgfVxuXG4gIGV4cG9ydCB0eXBlIENhdXNlID0gdW5kZWZpbmVkO1xufVxuXG5leHBvcnQgdHlwZSBQcGZ0S2V5Tm90Rm91bmRFcnJvciA9IEluY2lkZW50PFBwZnRLZXlOb3RGb3VuZEVycm9yLkRhdGEsXG4gIFBwZnRLZXlOb3RGb3VuZEVycm9yLk5hbWUsXG4gIFBwZnRLZXlOb3RGb3VuZEVycm9yLkNhdXNlPjtcblxuZXhwb3J0IG5hbWVzcGFjZSBQcGZ0S2V5Tm90Rm91bmRFcnJvciB7XG4gIGV4cG9ydCB0eXBlIFR5cGUgPSBQcGZ0S2V5Tm90Rm91bmRFcnJvcjtcblxuICBleHBvcnQgZnVuY3Rpb24gZm9ybWF0KHtodG1sfTogRGF0YSkge1xuICAgIHJldHVybiBcIlVuYWJsZSB0byBmaW5kIHRoZSBQUEZUIGtleSBmb3IgaHR0cHM6Ly9sb2dpbi5saXZlLmNvbS8uXCJcbiAgICAgICsgXCIgVGhpcyBrZXkgaXMgbm9ybWFsbHkgZm91bmQgaW4gdGhlIEhUTUwgcmVzcG9uc2UsIGluIGEgSmF2YXNjcmlwdCBsaXRlcmFsIHN0cmluZyBjb250YWluaW5nIGFuIEhUTUwgaW5wdXRcIlxuICAgICAgKyBcIiB3aXRoIHRoZSBhdHRyaWJ1dGUgbmFtZT1cXFwiUFBGVFxcXCIsIHRoZSBrZXkgaXMgdGhlIHZhbHVlIG9mIHRoaXMgaW5wdXQgYW5kIGlzIGV4dHJhY3RlZCB3aXRoIGEgcmVndWxhclwiXG4gICAgICArIFwiIGV4cHJlc3Npb24uIFRoaXMgZXJyb3IgbWF5IGJlIGNhdXNlZCBieSBhIGNoYW5nZSBpbiB0aGUgTWljcm9zb2Z0IGxvZ2luIHdvcmtmbG93LlwiXG4gICAgICArIGAgSFRNTCBwYWdlOiAke0pTT04uc3RyaW5naWZ5KGh0bWwpfWA7XG4gIH1cblxuICBleHBvcnQgZnVuY3Rpb24gY3JlYXRlKGh0bWw6IHN0cmluZyk6IFBwZnRLZXlOb3RGb3VuZEVycm9yIHtcbiAgICByZXR1cm4gbmV3IEluY2lkZW50KG5hbWUsIHtodG1sfSwgZm9ybWF0KTtcbiAgfVxufVxuXG5leHBvcnQgbmFtZXNwYWNlIEdldExpdmVLZXlzRXJyb3Ige1xuICBleHBvcnQgdHlwZSBOYW1lID0gXCJHZXRMaXZlS2V5c1wiO1xuICBleHBvcnQgY29uc3QgbmFtZTogTmFtZSA9IFwiR2V0TGl2ZUtleXNcIjtcblxuICBleHBvcnQgaW50ZXJmYWNlIERhdGEge1xuICB9XG5cbiAgZXhwb3J0IHR5cGUgQ2F1c2UgPSBSZXF1ZXN0RXJyb3IgfCBNc3Bva0Nvb2tpZU5vdEZvdW5kRXJyb3IgfCBNc3ByZXF1Q29va2llTm90Rm91bmRFcnJvciB8IFBwZnRLZXlOb3RGb3VuZEVycm9yO1xufVxuXG5leHBvcnQgdHlwZSBHZXRMaXZlS2V5c0Vycm9yID0gSW5jaWRlbnQ8R2V0TGl2ZUtleXNFcnJvci5EYXRhLCBHZXRMaXZlS2V5c0Vycm9yLk5hbWUsIEdldExpdmVLZXlzRXJyb3IuQ2F1c2U+O1xuXG5leHBvcnQgbmFtZXNwYWNlIEdldExpdmVLZXlzRXJyb3Ige1xuICBleHBvcnQgdHlwZSBUeXBlID0gR2V0TGl2ZUtleXNFcnJvcjtcblxuICBleHBvcnQgZnVuY3Rpb24gZm9ybWF0KCkge1xuICAgIHJldHVybiBcIlVuYWJsZSB0byBnZXQgdGhlIE1TUFJlcXUsIE1TUE9LIGFuZCBQUEZUIGtleXMgZnJvbSBsb2dpbi5saXZlLmNvbVwiO1xuICB9XG5cbiAgZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZShjYXVzZTogQ2F1c2UpOiBHZXRMaXZlS2V5c0Vycm9yIHtcbiAgICByZXR1cm4gSW5jaWRlbnQoY2F1c2UsIG5hbWUsIHt9LCBmb3JtYXQpO1xuICB9XG59XG4iXSwic291cmNlUm9vdCI6Ii4uLy4uIn0=
