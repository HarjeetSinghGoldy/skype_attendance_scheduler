import { Incident } from "incident";
import { JSON_SERIALIZER } from "../json";
import { name as typeName } from "../types/white-list";
export function register(serializer) {
    function write(type, val) {
        return serializer.write(type.itemType, val);
    }
    function read(type, input) {
        const value = JSON_SERIALIZER.read(type.itemType, input);
        for (const allowed of type.values) {
            if (type.itemType.equals(value, allowed)) {
                return value;
            }
        }
        throw Incident("UnkownVariant", "Unknown variant");
    }
    function readTrusted(type, input) {
        return serializer.readTrusted(type.itemType, input);
    }
    serializer.register({
        typeName,
        write,
        read,
        readTrusted,
    });
}
