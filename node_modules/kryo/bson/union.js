"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const incident_1 = require("incident");
const union_1 = require("../types/union");
function register(serializer) {
    function write(type, val) {
        return serializer.write(type.trustedMatcher(val), val);
    }
    function readWithVariant(type, input) {
        const variant = type.readMatcher(input, serializer);
        if (variant === undefined) {
            throw new incident_1.Incident("UnknownUnionVariant", "Unknown union variant");
        }
        return [serializer.read(variant, input), variant];
    }
    function read(type, input) {
        return readWithVariant(type, input)[0];
    }
    function readTrustedWithVariant(type, input) {
        const variant = type.readTrustedMatcher(input, serializer);
        return [serializer.readTrusted(variant, input), variant];
    }
    function readTrusted(type, input) {
        return readTrustedWithVariant(type, input)[0];
    }
    serializer.register({
        typeName: union_1.name,
        write,
        read,
        readTrusted,
    });
}
exports.register = register;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJzb24vdW5pb24udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSx1Q0FBb0M7QUFFcEMsMENBQTZEO0FBRTdELGtCQUF5QixVQUFzQjtJQUM3QyxlQUFrQixJQUFrQixFQUFFLEdBQU07UUFDMUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxHQUFHLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQztJQUN6RCxDQUFDO0lBRUQseUJBQTRCLElBQWtCLEVBQUUsS0FBVTtRQUN4RCxNQUFNLE9BQU8sR0FBd0IsSUFBSSxDQUFDLFdBQVcsQ0FBQyxLQUFLLEVBQUUsVUFBVSxDQUFDLENBQUM7UUFDekUsRUFBRSxDQUFDLENBQUMsT0FBTyxLQUFLLFNBQVMsQ0FBQyxDQUFDLENBQUM7WUFDMUIsTUFBTSxJQUFJLG1CQUFRLENBQUMscUJBQXFCLEVBQUUsdUJBQXVCLENBQUMsQ0FBQztRQUNyRSxDQUFDO1FBQ0QsTUFBTSxDQUFDLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsS0FBSyxDQUFDLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDcEQsQ0FBQztJQUVELGNBQWlCLElBQWtCLEVBQUUsS0FBVTtRQUM3QyxNQUFNLENBQUMsZUFBZSxDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUN6QyxDQUFDO0lBRUQsZ0NBQW1DLElBQWtCLEVBQUUsS0FBVTtRQUMvRCxNQUFNLE9BQU8sR0FBWSxJQUFJLENBQUMsa0JBQWtCLENBQUMsS0FBSyxFQUFFLFVBQVUsQ0FBQyxDQUFDO1FBQ3BFLE1BQU0sQ0FBQyxDQUFDLFVBQVUsQ0FBQyxXQUFXLENBQUMsT0FBTyxFQUFFLEtBQUssQ0FBQyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQzNELENBQUM7SUFFRCxxQkFBd0IsSUFBa0IsRUFBRSxLQUFVO1FBQ3BELE1BQU0sQ0FBQyxzQkFBc0IsQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDaEQsQ0FBQztJQUVELFVBQVUsQ0FBQyxRQUFRLENBQUM7UUFDbEIsUUFBUSxFQUFSLFlBQVE7UUFDUixLQUFLO1FBQ0wsSUFBSTtRQUNKLFdBQVc7S0FDWixDQUFDLENBQUM7QUFDTCxDQUFDO0FBaENELDRCQWdDQyIsImZpbGUiOiJic29uL3VuaW9uLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5jaWRlbnQgfSBmcm9tIFwiaW5jaWRlbnRcIjtcbmltcG9ydCB7IFNlcmlhbGl6ZXIsIFR5cGUgfSBmcm9tIFwiLi4vdHlwZXNcIjtcbmltcG9ydCB7IG5hbWUgYXMgdHlwZU5hbWUsIFVuaW9uVHlwZSB9IGZyb20gXCIuLi90eXBlcy91bmlvblwiO1xuXG5leHBvcnQgZnVuY3Rpb24gcmVnaXN0ZXIoc2VyaWFsaXplcjogU2VyaWFsaXplcik6IHZvaWQge1xuICBmdW5jdGlvbiB3cml0ZTxUPih0eXBlOiBVbmlvblR5cGU8VD4sIHZhbDogVCk6IGFueSB7XG4gICAgcmV0dXJuIHNlcmlhbGl6ZXIud3JpdGUodHlwZS50cnVzdGVkTWF0Y2hlcih2YWwpLCB2YWwpO1xuICB9XG5cbiAgZnVuY3Rpb24gcmVhZFdpdGhWYXJpYW50PFQ+KHR5cGU6IFVuaW9uVHlwZTxUPiwgaW5wdXQ6IGFueSk6IFtULCBUeXBlPFQ+XSB7XG4gICAgY29uc3QgdmFyaWFudDogVHlwZTxUPiB8IHVuZGVmaW5lZCA9IHR5cGUucmVhZE1hdGNoZXIoaW5wdXQsIHNlcmlhbGl6ZXIpO1xuICAgIGlmICh2YXJpYW50ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBJbmNpZGVudChcIlVua25vd25VbmlvblZhcmlhbnRcIiwgXCJVbmtub3duIHVuaW9uIHZhcmlhbnRcIik7XG4gICAgfVxuICAgIHJldHVybiBbc2VyaWFsaXplci5yZWFkKHZhcmlhbnQsIGlucHV0KSwgdmFyaWFudF07XG4gIH1cblxuICBmdW5jdGlvbiByZWFkPFQ+KHR5cGU6IFVuaW9uVHlwZTxUPiwgaW5wdXQ6IGFueSk6IFQge1xuICAgIHJldHVybiByZWFkV2l0aFZhcmlhbnQodHlwZSwgaW5wdXQpWzBdO1xuICB9XG5cbiAgZnVuY3Rpb24gcmVhZFRydXN0ZWRXaXRoVmFyaWFudDxUPih0eXBlOiBVbmlvblR5cGU8VD4sIGlucHV0OiBhbnkpOiBbVCwgVHlwZTxUPl0ge1xuICAgIGNvbnN0IHZhcmlhbnQ6IFR5cGU8VD4gPSB0eXBlLnJlYWRUcnVzdGVkTWF0Y2hlcihpbnB1dCwgc2VyaWFsaXplcik7XG4gICAgcmV0dXJuIFtzZXJpYWxpemVyLnJlYWRUcnVzdGVkKHZhcmlhbnQsIGlucHV0KSwgdmFyaWFudF07XG4gIH1cblxuICBmdW5jdGlvbiByZWFkVHJ1c3RlZDxUPih0eXBlOiBVbmlvblR5cGU8VD4sIGlucHV0OiBhbnkpOiBUIHtcbiAgICByZXR1cm4gcmVhZFRydXN0ZWRXaXRoVmFyaWFudCh0eXBlLCBpbnB1dClbMF07XG4gIH1cblxuICBzZXJpYWxpemVyLnJlZ2lzdGVyKHtcbiAgICB0eXBlTmFtZSxcbiAgICB3cml0ZSxcbiAgICByZWFkLFxuICAgIHJlYWRUcnVzdGVkLFxuICB9KTtcbn1cbiJdLCJzb3VyY2VSb290IjoiLi4ifQ==
